---
layout: doc
description: Learn about the required components of every Citrix virtualization system, options for serving them, and when to use each.
---
# Choosing the Right Components for your Citrix Virtualization System

## Contributors

**Authors:** [Rick Dehlinger](mailto:rick.dehlinger@citrix.com), 

**Special Thanks:** Someone super cool.

### Audience and Objective


## Executive Summary

### Technology Delivery/Adoption Models
To help readers understand the design decisions presented here, we'll introduce the distinction between **Customer Managed** and **Cloud Service** adoption models. Simply put:
-  **Customer Managed** technologies are deployed and managed by/for the customer, typically by downloading and installing binaries on infrastructure they manage, or buying and installing physical gear like networking appliances. CVAD (LTSR or CR), Citrix ADC/Gateway, and Citrix StoreFront are examples of customer managed techologies.
-  **Cloud Service** based technologies are delivered as managed services, and often consumed by securely connecting to them over public networks. The Citrix Virtual Apps and Desktops Service (CVADS), Citrix Gateway Service (CGS), and Citrix Workspace Service are examples of cloud services.

For a more detailed breakdown of this differentiation and the impact it has on your design decisions, see this [primer on Technology Delivery/Adoption Models](/en-us/tech-zone/design/reference-architectures/primer-technology-adoption-models.html).

### Citrix Virtualization System Components

To understand the implications of the design decisions we'll detail later in this document, we're going to put the components of a Citrix virtualization system into higher level 'buckets' we'll then use to guide your decision-making process. Every Citrix virtualization system, regardless of how it is deployed and licensed, needs these components available to function and provide the best, most secure user experience. It is not uncommon for customers to mix and match self-managed components and cloud services, especially if they've got complex use case requirements, third party integration requirements, or extreme control or availability needs.

The following table highlights these key components for clarity. Details and recommendations on when/where you'd use one option vs another is covered later in this document:

| Adoption Model / Subsystem function | Customer Managed (installed from downloaded binaries) | Cloud Service (delivered via Citrix Cloud) |
|---|---|---|
|**Session brokering and administration** - The core of any Citrix virtualization system: without this core subsystem, you don't have any apps or desktops, and you can't manage them! This subsystem is where you define, provision, and update Machine Catalogs (collections of Citrix Virtual Delivery Agent or "VDA" VM instances). It is also where you create Delivery Groups, assigning apps/desktops to users, and administer the environment and user sessions. | **CVAD - Citrix Virtual Apps and Desktops**, either Long Term Service Release (LTSR) or Current Release (CR) versions. If you install and configure a delivery controller in your environment, this is what you're running. It also means you're installing and managing your own Microsoft SQL Server infrastructure. Administrative functions in a customer managed (CVAD) deployment include Citrix Director and Citrix Studio. You install, configure, and manage these yourself using LTSR/CR binaries. Director also requires Microsoft SQL Server infrastructure. Citrix licensing is also a part of this subsystem, with customers installing/configuring/ managing Citrix License Servers and license files. | **CVADS - Citrix Virtual Apps and Desktops Service**, delivered via Citrix Cloud. If you're logging into Citrix Cloud and installing and registering Cloud connectors in your environment, you're using this Citrix Cloud service. You install and register Cloud Connectors on Windows instances you manage, and then Citrix keeps them evergreen and available. Citrix Cloud also provides and maintains most administrative functionality via a web browser through the Citrix Cloud console. This includes cloud service versions of Citrix Studio and Citrix Director. There is no additional infrastructure for the customer to maintain, keep highly available, or patch/update: Citrix owns this administrative responsibility. |
|**UI (user interface) services** - Native Citrix Workspace apps (and web browsers for clientless access) ultimately connect to a URL. The subsystem behind the URL is configured by IT administrators to match corporate requirements for authentication, and to present virtualized apps/desktops, SaaS apps, and possibly much more for users to access. | **Citrix Storefront**. Also installed/ configured from CVAD LTSR or CR binaries, this role provides extreme flexibility for the most complex deployment scenarios. Typically deployed in pairs, with Citrix ADC/Gateway instances in front of them for high availability. Can aggregate and present apps and desktops from both customer managed/brokered environments (CVAD) and Citrix Cloud managed/brokered environments (CVADS). | **Citrix Workspace** (the service, not the Citrix Workspace app). Provided as a cloud service through Citrix Cloud, and includes many next generation capabilities that are only available with this service. Can aggregate and present apps and desktops from both customer managed/brokered environments (CVAD) and Citrix Cloud managed/brokered environments (CVADS). |
| **Authentication** - In this context, we're referring to how users authenticate before accessing Citrix virtualized apps/desktops, files, SaaS apps, and more. Authentication in a Citrix environment is typically configured at the UI services layer, though Citrix ADC/Gateway can also be used for authentication in all deployment models. Each of the UI service provider options (Citrix StoreFront or Citrix Workspace) has different authentication options available, some requiring a customer managed Citrix ADC/Gateway. | **Citrix StoreFront** (plus **Citrix ADC/Gateway** for most use cases). User authentication services can be provided various different ways, though ultimately require an Active Directory instance and valid user accounts. The customer typically manages the AD instance. Citrix ADC/Gateway instances can also be used to provide authentication services, and provide a ton of advanced capabilities that are commonly used for more complex environments. Citrix Federated Authentication Services (FAS) can also be installed and used to provide session SSO for complex use cases. | **Citrix Workspace** (plus **Citrix ADC/Gateway** for certain use cases). With Citrix Workspace (the service), user authentication sources and requirements are configured once for the Citrix Cloud tenant and used by all users using this URL. It is configured for Active Directory out of the box, but for advanced use cases, can be configured to support other authentication providers. Examples include Azure AD, Okta, customer managed Citrix Gateway, Google Cloud ID, or other SAML/OpenID/RADIUS providers. Some scenarios require customer managed Citrix ADC/Gateways and Citrix Federated Authentication Services (FAS) for the best user experience. |
| **HDX session proxy** - The ability to securely and seamlessly connect users/devices outside the private corporate network to CVAD/CVADS delivered apps and desktops on the inside. | **Citrix ADC/Gateway** appliances - these appliances (or instances) often provide a ton of extra functionality for a Citrix virtualization system. Their core job, however, is to securely proxy HDX sessions to your VDAs when clients are on public networks. Requires installation, configuration, SSL certificates, and such. Compatible with both StoreFront (customer managed UI services) and Workspace cloud service. Also compatible with both Citrix managed and customer managed session brokering options. | **Citrix Gateway Service** - provided by Citrix Cloud, this service proxies HDX session traffic to your VDAs, and it uses Citrix managed infrastructure to get the job done. Requires no public IP addresses, SSL certs, or ingress firewall rules to operate. Compatible with the Citrix Workspace service and both Citrix Cloud managed and customer managed session brokering options (CVAD and CVADS). |

## Design Decisions

This section explores key design decisions to consider as you're architecting your Citrix virtualization system on AWS. We'll walk down through each layer of the Citrix Architectural Design Framework, exploring key areas for you to consider.

### About the Citrix Architectural Design Framework

Citrix's Virtual Apps and Desktops solution (the product family name collectively referring to Citrix's virtualization technologies) enables organizations to create, control and manage virtual machines, deliver applications and desktops, and implement granular security policies. The Citrix Virtual Apps and Desktops solution provides a unified framework for developing a complete digital workspace offering. This offering enables Citrix users to access applications and desktops independent of their device's operating system and interface.

The Citrix architectural design framework is based on a unified and standardized layer model. It provides a consistent and easily accessible framework for understanding the technical architecture for most of the common Virtual Apps and Desktops deployment scenarios. These layers are depicted in the following conceptual diagram:
![Diagram X: Conceptual Architecture, Citrix Virtual Apps and Desktops Service](/en-us/tech-zone/design/media/reference-architectures_citrix-virtual-apps-and-desktops-on-gcp_cadf.png)
*Diagram X: Conceptual Architecture, Citrix Virtual Apps and Desktops Service.*

-  ***User Layer*** - This layer defines user groups and locations of
    the Citrix environment.
-  ***Access layer*** - This layer defines how users access the
    resources.
-  ***Control layer*** - This layer defines the components that control
    the Citrix solution.
-  ***Resource layer*** - This layer defines provisioning of Citrix
    workloads and how resources are assigned to the given users.
-  ***Platform layer*** - This layer defines the physical elements
    where the hypervisor components and cloud service provider framework run to host the Citrix workloads.
-  ***Operations Layer*** - This layer defines the tools that support
    the delivery of the core solutions.

## Design Decisions - User Layer Considerations

In the Citrix Architectural Design Framework, the User layer describes the user groups, their locations, specific requirements, and more. The user layer appropriately sets the overall direction for each user group's environment. This layer incorporates the assessment criteria for business priorities and user group requirements to define effective strategies for endpoints and Citrix Workspace App. These design decisions affect the flexibility and functionality for each user group.

When designing and deploying a Citrix virtualization system on any platform, the decisions and strategies adopted after careful assessment set the foundation for many other decisions that customers ought to consider as they work their way down through the other layers in the Citrix Architectural Design Framework. As such, this is a critical layer to understand thoroughly and get right\!

Fortunately, these considerations are already well documented, and don't differ substantially between systems deployed on GCP and any other hardware/cloud platform. For a thorough primer on the design considerations for this layer, see [Citrix VDI Handbook and Best Practices for XenApp and XenDesktop 7.15 LTSR](/en-us/xenapp-and-xendesktop/7-15-ltsr/downloads/handbook-715-ltsr.pdf) document, and the [Design methodology user layer](/en-us/xenapp-and-xendesktop/7-15-ltsr/citrix-vdi-best-practices/design/design-userlayer1.html) page in particular, for details.

## Design Decisions - Access Layer Considerations

In the Citrix Architectural Design Framework, the Access layer defines how users access virtualized apps and desktops. The design of your access layer is critical to the functionality delivered by any Citrix virtualization system. It controls how users authenticate to the system. It also controls how users view and launch virtualized applications and desktops, plus what type of applications and content are available to them. Additionally, the Access layer controls how and when sessions are securely proxied or directly connected.

In the context of the [Citrix virtualization system components](#citrix-virtualization-system-components) we defined earlier, the access layer contains the following components and choices:

| Citrix virtualization system component | Provided by: |
|---|---|
| UI services | Citrix Workspace Service (cloud service) **OR** Citrix StoreFront (customer managed) |
| Authentication | Citrix Workspace Service (Citrix ADC/Gateway optional) **OR** Citrix StoreFront (Citrix ADC/Gateway optional but common) |
| HDX session proxy | Citrix Gateway Service (cloud service) **OR** Citrix ADC/Gateway VPX (customer managed) |

The following table contains critical decision points when determining which access layer component to deploy based upon available or required attributes/capabilities:

### UI Service and Authentication Considerations

Consider the following when choosing how you want to provide UI services for your Citrix virtualization system:

| Attribute / Capability | Customer Managed (installed from downloaded binaries) | Cloud Service (delivered via Citrix Cloud) |
|---|---|---|
| Ability to present and launch virtualized apps and desktops from multiple "Citrix Farms." | **YES** - Both legacy environments (XenApp and XenDesktop 6.5/7.x, Citrix Virtual Apps and Desktops CR/LTSR) and Citrix Virtual Apps and Desktops Service. | **YES** - Both legacy environments (XenApp and XenDesktop 6.5/7.x, Citrix Virtual Apps and Desktops CR/LTSR) and Citrix Virtual Apps and Desktops Service. See [this article](/en-us/citrix-cloud/workspaces/add-on-premises-site.html) for more details. |
| Ability to create multiple 'Stores' with different settings for different use cases, including authentication requirements. | **YES** - StoreFront can be configured with multiple different Stores, and when combined with Citrix ADC/Gateway VPX, can apply sophisticated rules to direct certain devices or user groups to different stores. For more information, see [How SmartAccess Works for Citrix Virtual Apps and Desktops](/en-us/citrix-gateway/13/integrate-web-interface-apps/ng-smartaccess-wrapper-con/ng-smartaccess-how-it-works-con.html). One common scenario requiring two StoreFront Stores would be when users require published applications from inside a published desktop. Another common scenario would be a requirement of having an internal only Store (no Citrix Gateway access) for a specific use case and another Store configured for both internal and remote access. See [Configure and manage stores](/en-us/storefront/current-release/configure-manage-stores.html) for more information. | **NO** - the Workspace Service is essentially a single store, on a single URL. All users use the same store and Workspace settings. Authentication requirements are set up once, and apply to all users of the Workspace tenant. |
| Ability to enumerate, launch, and SSO into SaaS and web apps using the Citrix Access Control service, taking advantage of web-filtering and enhanced security control policies, plus advanced, ML enhanced analytics. | **YES** - using the [Access Control Sync for StoreFront](/en-us/citrix-cloud/advanced-concepts/access-control-saas-web-apps.html) utility. Requires an appropriate subscription to Citrix Cloud. | **YES** - With the Citrix Gateway Service, it is as simple as 'turning on' the integration in the Citrix Cloud Console. SaaS apps are defined simply from a web based wizard, and admins can use a substantial list of pre-defined apps as a starting point. |
| Ability to access/index/search Citrix Files (formerly ShareFile) content through the Citrix Workspace app and web browsers (HTML). | **NO** - StoreFront does not have the ability to integrate file-based content into either Workspace App or StoreFront HTML UIs. | **YES** - Enabled by default depending upon the subscription to Citrix Cloud. Brings users' file-based content from various sources (including on-premises file shares) into the Workspace UI, both HTML and Workspace App. |
| Ability to present and launch connections to physical desktops using the [Citrix Remote PC Access](/en-us/citrix-virtual-apps-desktops/install-configure/remote-pc-access.html) feature. | **YES** - Regardless of whether brokering is handled by CVAD or CVADS. | **YES** - Regardless of whether brokering is handled by CVAD or CVADS. |
| Ability to guide users' work and automate repetitive tasks by using microapps integrated with various different SaaS and custom applications. | **NO** - The microapps feature is not currently available with Citrix StoreFront. | **YES** - Presents users with a 'feed' in the Workspace UI that intelligently surfaces notifications, tasks, and workflows defined by in-box and custom microapps and the low code Microapp builder console. See [Workspace Intelligence Features - Microapps](/en-us/tech-zone/learn/tech-briefs/workspace-microapps.html) and [Microapps](/en-us/citrix-microapps) on Citrix Docs for more information. |
| For multi-site and DR use cases, ability to granularly control session launch behavior using Zone Preference and Failover. | **YES** - Using Citrix Zones for deployments across multiple GCP Regions is a great way to expand east-west and limit the affected user base in the case of an outage, and allows for Region preference and failover to the Primary Zone seamlessly. See [CVAD Zones documentation](/en-us/citrix-virtual-apps-desktops/manage-deployment/zones.html). | **Partial** - Workspace service doesn't include the fully featured zone preference and failover functionality, but a similar effect can be implemented using home zones for users or apps. See [CVADS Zones documentation](/en-us/citrix-virtual-apps-desktops-service/manage-deployment/zones.html) for details. |
| Ability to broker new and existing connections when a connection between a resource location/zone and Citrix Cloud fails, or when the databases underneath Citrix Delivery Controllers are unavailable. | **YES** - Uses the Local Host Cache feature on both Cloud Connectors and Delivery Controllers to provide resiliency for these two potential failure scenarios. **For environments with extensive resiliency requirements, Citrix recommends deploying StoreFront with Local Host Cache.** For more information see [Local Host Cache (CVAD)](/en-us/citrix-virtual-apps-desktops/manage-deployment/local-host-cache.html). | **YES** - Cloud Connectors use the Local Host Cache feature to broker resource connections in the event of Citrix Cloud communication failure. This requires passive StoreFront servers accessible by your resource locations to handle failover scenarios. For more information see [Local Host Cache (CVADS)](/en-us/citrix-virtual-apps-desktops-service/manage-deployment/local-host-cache.html). |
| Ability to configure and utilize a customized 'vanity URL' for end-user consumption. | **YES** - Customer has full control of the URL's and certificates used and presented to users. Does require SSL certificates, DNS alias creation/management, and Citrix ADC/Gateway instances for ingress over public networks. | **Partial** - All Workspaces are delivered from the cloud.com domain, though customers can [configure their own customized prefix](/en-us/citrix-cloud/workspace-configuration.html) (customername.cloud.com). |
| Ability to intelligently route on-network users directly to VDAs and off-network users through Citrix ADC/Gateway VPX or Citrix Gateway Service. | **YES** - StoreFront uses administrator defined 'beacons', which the Citrix Workspace app uses to determine if a user is on or off-network. | **Coming Soon** - This feature is expected to be available on Citrix Workspace with the release of the Network Location Service once it is generally available. For more information, see [Network Location Service preview](/en-us/citrix-cloud/workspace-network-location.html). |
| Ability to use Citrix Gateway Service for simple, pre-configured HDX session proxy services. | **NO** - If off-network access to Citrix virtualized apps is a requirement (and it is in 99% of deployments), StoreFront requires the use of customer managed Citrix ADC/Gateway for HDX session proxy functionality. | **YES** - This feature is provisioned and enabled by default for all new Citrix Workspace tenants. |
| Includes built-in multifactor authentication via Active Directory and TOTP. | **YES** - Citrix ADC includes built-in TOTP functionality for use with third-party authenticators, and also supports third-party apps/devices/services. | **YES** - Citrix Workspace includes this feature, including self-service OTP device recovery and automatic push notifications to end users. Supports both Citrix and third-party authenticator apps. |
| SSO capabilities (Virtualized, SaaS, and Web apps) | **Partial** - SSO to virtualized apps out of the box. Requires [Access Control Sync for StoreFront](/en-us/citrix-cloud/advanced-concepts/access-control-saas-web-apps.html) utility for SaaS and Web apps. | **YES** - SSO to virtualized, SaaS, and web apps natively available with Citrix Workspace. Gateway Service and Access control include Web Filtering and Policy Controls. |
| Ability to choose from multiple pre-defined authentication methods and have the chosen method apply to all users on the system. | **YES**  - with more options and flexibility. Citrix StoreFront allows you to create multiple Stores, and authentication methods are configured on a per store basis. One or more options can be configured per store, and admins can select from Active Directory username/password, SAML authentication, domain pass-through, Smart Card, HTTP Basic, and Pass-through from Citrix Gateway options. Self service password reset can also be enabled. See [Configure the authentication service](/en-us/storefront/current-release/configure-authentication-and-delegation/configure-authentication-service.html) for more information. When Citrix ADC/Gateway (customer managed) is deployed and used with StoreFront, a various authentication options can be configured, along with additional logic to direct users to a specific Store as needed to support almost any use case.  Citrix StoreFront and Citrix ADC/Gateway are recommended where complex integrations and different authentication methods are required for different use cases. | **YES** - Currently, Active Directory, Azure AD, Active Directory + TOTP Token, Azure AD, and Citrix Gateway are currently supported options. Okta and Google Cloud ID options are in preview or coming soon. See [Secure workspaces](/en-us/citrix-workspace/secure.html) for more information. Except for Citrix Gateway, your authentication choice applies to all users and all services provided through the Citrix Workspace tenant/URL. With the Citrix Gateway option, customers can support various authentication options (RADIUS MFA, smart card, federation, conditional access policies, and more) and flexibly apply them to different groups of users and use cases. For more information, see [Connect an on-premises Citrix Gateway as an identity provider to Citrix Cloud](/en-us/citrix-cloud/citrix-cloud-management/identity-access-management/connect-ad-gateway.html). |
| Ability to SSO to sessions on VDAs when launching virtualized Windows apps/desktops using federated identity providers | **YES** - Citrix [Federated Authentication Service](/en-us/federated-authentication-service.html) (FAS) enables SSO to VDAs when using a federated identity provider such as SAML (Security Assertion Markup Language). | **Coming Soon** - By using Citrix [Federated Authentication Service](/en-us/federated-authentication-service.html) (FAS) with Citrix Workspace. This feature is in preview as of this writing. See [Enable SSO for Workspaces with Citrix FAS](/en-us/citrix-workspace/workspace-federated-authentication.html) for more information. |

#### HDX Session Proxy Considerations

Consider the following when choosing how you want to provide HDX session proxy functionality for your Citrix virtualization system:

| Attribute / Capability | Customer Managed (Citrix ADC/Gateway) | Cloud Service ([Citrix Gateway Service](/en-us/citrix-gateway-service.html) provided by Citrix Cloud) |
|---|---|---|
| Simple, pre-configured service, providing HDX proxy with no administrative overhead | **NO** - As a customer managed component, these appliances require licensing, installation, configuration, and maintenance. | **YES** - [Citrix Gateway Service](/en-us/citrix-gateway-service.html) is a complete HDX proxy solution, managed by Citrix, delivered as a cloud service. |
| Ability to use Citrix HDX's EDT (UDP) based transport protocol. For more information, see [Adaptive Transport](/en-us/citrix-virtual-apps-desktops/technical-overview/hdx/adaptive-transport.html) and [How to Configure HDX Enlightened Data Transport Protocol](https://support.citrix.com/article/CTX220732). | **YES** - This feature optimizes traffic from high-latency sites and is available for customer managed ADC/Gateway instances. | **Not Yet** - This feature is in preview as of this writing. The Gateway Service currently only supports TCP based connections to VDAs. |
| Ability to provide load balancing, health checking, SSL offload, and various other advanced networking and application delivery services for customer managed infrastructure. | **YES** - Citrix ADC/Gateway VPX appliances provide very sophisticated, industry leading capabilities, many of which can be enabled by simply applying the appropriate type of license to the appliance. | **NO** - For Citrix CVAD and CVADS brokered environments, the Gateway Service provides simple, secure access to virtualized applications running either in customer's Google Cloud or on-prem environments. |
| Support for customer configurable Global Server Load Balancing (GSLB) between data centers, zones, and regions. | **YES** - Customer managed Citrix ADC/Gateway instances can be set up for GSLB, though the customer is responsible for setup and management. | **NO** - ...however there is no real need for it: the Gateway Service uses [14 or more POP's worldwide plus integrated GSLB](https://www.citrix.com/blogs/2019/07/02/new-citrix-gateway-pops-now-available-in-india-and-south-africa/) to ensure users get the best possible session performance regardless of where in the world they are. |
| Requires use of Citrix Workspace UI for HDX session presentation and launching. | **NO** - It is possible to use customer managed Citrix ADC/Gateway VPX instances with both Workspace UI and StoreFront. | ** **YES** - The Gateway Service is only configurable through the Citrix Workspace UI for HDX proxy - it does NOT provide HDX proxy capabilities for Citrix StoreFront. |
| Requires additional resources on Cloud Connector instances to proxy sessions into secured networks. | **NO** - While Cloud Connectors perform STA ticket validation for customer managed Citrix ADC/Gateway VPX instances, no additional resources are needed since all HDX sessions are proxied through the VPXs. | **YES** - Today the Gateway Service uses long lived, outbound TCP connections from the Cloud Connector instances to Citrix Cloud to proxy HDX traffic back into private networks. This requires additional resource considerations when sizing and configuring Cloud Connector instances. See [this article](/en-us/citrix-virtual-apps-desktops-service/install-configure/install-cloud-connector/cc-scale-and-size.html) for more details. **Note** - this requirement is moot for most use cases once the Gateway Service and VDAs can use the Rendezvous protocol/feature. This requires Citrix VDA 1912 or newer. |
| Ability to be used with Citrix Cloud Government tenants. | **YES** - Both on-prem and Google Cloud-based ADC/Gateway/StoreFront deployments are supported. | **YES** - Citrix Workspace is available in Citrix Cloud Government. |